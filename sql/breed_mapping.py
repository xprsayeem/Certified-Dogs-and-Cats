# Databricks notebook source
# MAGIC %sql
# MAGIC USE CATALOG pets;
# MAGIC CREATE SCHEMA IF NOT EXISTS pets.ref COMMENT 'Reference data for standardization';
# MAGIC
# MAGIC CREATE TABLE IF NOT EXISTS pets.ref.breed_mapping (
# MAGIC   breed_variant_key STRING,      -- normalized key from raw animal_breed values - upper case, trim, alphabet only
# MAGIC   breed_standard    STRING       -- final canonical labels
# MAGIC )
# MAGIC USING DELTA
# MAGIC

# COMMAND ----------

# MAGIC %sql
# MAGIC USE CATALOG pets;
# MAGIC
# MAGIC -- 1) Put your raw pairs here, un-normalized is fine
# MAGIC WITH v(key, val) AS (
# MAGIC   VALUES
# MAGIC   -- dogs
# MAGIC   ('GOLDENRETR',       'GOLDEN RETRIEVER'),
# MAGIC   ('MALETESE',         'MALETESE'),
# MAGIC   ('LABRADORRETR',     'LABRADOR RETRIEVER'),
# MAGIC   ('GERMANSHEPHERD',   'GERMAN SHEPHERD DOG'),
# MAGIC   ('GERMSHEPHERD',     'GERMAN SHEPHERD DOG'),
# MAGIC   ('AUSTSHEPHERD',     'AUSTRALIAN SHEPHERD'),
# MAGIC   ('JACKRUSSELL',      'JACK RUSSELL TERRIER'),
# MAGIC   ('PARSONRUSSELL',    'PARSON RUSSELL TERRIER'),
# MAGIC   ('PARSONRUSSTER', 'PARSON RUSSELL TERRIER'),
# MAGIC   ('SHETLDSHEEPDOG',   'SHETLAND SHEEPDOG'),
# MAGIC   ('OLDENGSHEEPDOG',   'OLD ENGLISH SHEEPDOG'),
# MAGIC   ('VIZSLA',           'VIZSLA'),
# MAGIC   ('YORKSHIRETERR',    'YORKSHIRE TERRIER'),
# MAGIC   ('BEAGLE',           'BEAGLE'),
# MAGIC   ('POMERANIAN',       'POMERANIAN'),
# MAGIC   ('UNKNOWN',          'UNKNOWN'),
# MAGIC   ('HAVANESE',         'HAVANESE'),
# MAGIC   ('BICHONFRISE',     'BICHON FRISE'),
# MAGIC   ('TERRIER',          'TERRIER'),
# MAGIC   ('SHIBAINU',            'SHIBA INU'),
# MAGIC   ('SCWHEATTERR',         'SOFT COATED WHEATEN TERRIER'),
# MAGIC   ('WELSHCORGIPEM',       'PEMBROKE WELSH CORGI'),
# MAGIC   ('CANECORSO',           'CANE CORSO'),
# MAGIC   ('ENGSPRNGRSPAN',       'ENGLISH SPRINGER SPANIEL'),
# MAGIC   ('COTONDETULEAR',       'COTON DE TULEAR'),
# MAGIC   ('CHOWCHOW',            'CHOW CHOW'),
# MAGIC   ('RHODRIDGEBACK',       'RHODESIAN RIDGEBACK'),
# MAGIC   ('BORDERTERRIER',       'BORDER TERRIER'),
# MAGIC   ('LHASAAPSO',           'LHASA APSO'),
# MAGIC   ('PAPILLON',            'PAPILLON'),
# MAGIC   ('CHINESESHARPEI',      'CHINESE SHAR-PEI'),
# MAGIC   ('BASSETHOUND',         'BASSET HOUND'),
# MAGIC   ('ENGCOCKERSPAN',       'ENGLISH COCKER SPANIEL'),
# MAGIC   ('PEKINGESE',           'PEKINGESE'),
# MAGIC   ('PRESACANARIO',        'PRESA CANARIO'),
# MAGIC   ('FOXTERRWIRE',         'FOX TERRIER WIRE'),
# MAGIC   ('DALMATIAN',           'DALMATIAN'),
# MAGIC   ('BOUVFLANDRES',        'BOUVIER DES FLANDRES'),
# MAGIC   ('BOMBAY',              'BOMBAY'),
# MAGIC   ('BRUSSGRIFFON',        'BRUSSELS GRIFFON'),
# MAGIC   ('BASENJI',             'BASENJI'),
# MAGIC   ('CHINESECRESTED',      'CHINESE CRESTED'),
# MAGIC   ('ENGSETTER',           'ENGLISH SETTER'),
# MAGIC   ('BURMESE',             'BURMESE'),
# MAGIC   ('LAGOTTOROMAGNO',      'LAGOTTO ROMAGNOLO'),
# MAGIC   ('WELSHSPRSPAN',        'WELSH SPRINGER SPANIEL'),
# MAGIC   ('PODENGOPEQUENO',      'PORTUGUESE PODENGO PEQUENO'),
# MAGIC   ('TIBETANTERR',         'TIBETAN TERRIER'),
# MAGIC   ('ABYSSINIAN',          'ABYSSINIAN'),
# MAGIC   ('MIX',                 'MIXED BREED'),
# MAGIC   ('STAFFORDSHIRE',       'STAFFORDSHIRE BULL TERRIER'),
# MAGIC   ('PLOTTHOUND',          'PLOTT HOUND'),
# MAGIC   ('POTCAKE',             'POTCAKE'),
# MAGIC   ('MUNSTERLANDER',       'MUNSTERLANDER'),
# MAGIC   ('WELSHTERRIER',        'WELSH TERRIER'),
# MAGIC   ('FOXTERRSMOOTH',       'FOX TERRIER SMOOTH'),
# MAGIC   ('IRISHWOLFHOUND',      'IRISH WOLFHOUND'),
# MAGIC   ('TIBETANSPAN',         'TIBETAN SPANIEL'),
# MAGIC   ('AMERFOXHOUND',        'AMERICAN FOXHOUND'),
# MAGIC   ('NORWELKHOUND',        'NORWEGIAN ELKHOUND'),
# MAGIC   ('FINNISHSPITZ',        'FINNISH SPITZ'),
# MAGIC   ('EURASIER',            'EURASIER'),
# MAGIC   ('BEDLINGTONTERR',      'BEDLINGTON TERRIER'),
# MAGIC   ('ALASKKLEEKAI',        'ALASKAN KLEE KAI'),
# MAGIC   ('BARBET',              'BARBET'),
# MAGIC   ('MEXHAIRLESS',         'XOLOITZCUINTLI'),
# MAGIC   ('RETRIEVERLABR',       'LABRADOR RETRIEVER'),
# MAGIC   ('RUSSIANTERRIER',      'BLACK RUSSIAN TERRIER'),
# MAGIC   ('PULI',                'PULI'),
# MAGIC   ('MINIATUREPOODL',      'POODLE MINIATURE'),
# MAGIC   ('BELGSHEEPDOG',        'BELGIAN SHEEPDOG'),
# MAGIC   ('MANCHESTERTERR',      'MANCHESTER TERRIER'),
# MAGIC   ('FORMOSAMOUNTAI',      'FORMOSAN MOUNTAIN DOG'),
# MAGIC   ('AUSTTERRIER',         'AUSTRALIAN TERRIER'),
# MAGIC   ('ENGFOXHOUND',         'ENGLISH FOXHOUND'),
# MAGIC   ('BRIARD',              'BRIARD'),
# MAGIC   ('AKBASH',              'AKBASH'),
# MAGIC   ('SILKYTERRIER',        'SILKY TERRIER'),
# MAGIC   ('FILA',                'FILA BRASILEIRO'),
# MAGIC   ('NORWBUHUND',          'NORWEGIAN BUHUND'),
# MAGIC   ('AFFENPINSCHER',       'AFFENPINSCHER'),
# MAGIC   ('SNOWSHOE',            'SNOWSHOE'),
# MAGIC   ('RETRIEVERGOLD',       'GOLDEN RETRIEVER'),
# MAGIC   ('CHIHUAHUASHOR',       'CHIHUAHUA SHORTHAIR'),
# MAGIC   ('FIELDSPANIEL',        'FIELD SPANIEL'),
# MAGIC   ('SCOTDEERHOUND',       'SCOTTISH DEERHOUND'),
# MAGIC   ('SCHIPPERKE',          'SCHIPPERKE'),
# MAGIC   ('JACKRUSSELLTE',       'JACK RUSSELL TERRIER'),
# MAGIC   ('TIBETANMASTIFF',      'TIBETAN MASTIFF'),
# MAGIC   ('AMERICANBULLD',       'AMERICAN BULLDOG'),
# MAGIC   ('BERNESEHOUND',        'BERNESE HOUND'),
# MAGIC   ('OCICAT',              'OCICAT'),
# MAGIC   ('DACHSHUNDMINI',       'DACHSHUND MINIATURE'),
# MAGIC   ('DANDIEDINMONT',       'DANDIE DINMONT TERRIER'),
# MAGIC   ('BLACKTANHOUND',       'BLACK AND TAN COONHOUND'),
# MAGIC   ('ANGORA',              'TURKISH ANGORA'),
# MAGIC   ('IRISHWATRSPAN',       'IRISH WATER SPANIEL'),
# MAGIC   ('SHORTHAIREDCH',       'CHIHUAHUA SHORTHAIR'),
# MAGIC   ('SKYETERRIER',         'SKYE TERRIER'),
# MAGIC   ('POODLEMINIATU',       'POODLE MINIATURE'),
# MAGIC   ('GLENOFIMAAL',         'GLEN OF IMAAL TERRIER'),
# MAGIC   ('TIFFANY',             'CHANTILLY TIFFANY'),
# MAGIC   ('SCOTTISHSTRAIG',      'SCOTTISH STRAIGHT'),
# MAGIC   ('BLUELACY',            'BLUE LACY'),
# MAGIC   ('SILKENWINDHOUN',      'SILKEN WINDHOUND'),
# MAGIC   ('LOWCHEN',             'LOWCHEN'),
# MAGIC   ('BOYKINSPAN',          'BOYKIN SPANIEL'),
# MAGIC   ('AMERICANBULLDO',      'AMERICAN BULLDOG'),
# MAGIC   ('MIXED',               'MIXED BREED'),
# MAGIC   ('SWEDVALLHUND',        'SWEDISH VALLHUND'),
# MAGIC   ('JACKRUSSEL',          'JACK RUSSELL TERRIER'),
# MAGIC   ('BEAUCERON',           'BEAUCERON'),
# MAGIC   ('ICELANDICSHEEP',      'ICELANDIC SHEEPDOG'),
# MAGIC   ('BULLY',               'AMERICAN BULLY'),
# MAGIC   ('COTONDUTULEAR',       'COTON DE TULEAR'),
# MAGIC   ('CALICO',              'DOMESTIC SHORTHAIR'),
# MAGIC   ('BIEWERTERRIER',       'BIEWER TERRIER'),
# MAGIC   ('AUSTRALIANCOBB',      'AUSTRALIAN COBBERDOG'),
# MAGIC   ('WOLFHYBRID',          'WOLF HYBRID'),
# MAGIC   ('MORKIE',              'MORKIE'),
# MAGIC   ('POODLESTANDAR',       'POODLE STANDARD'),
# MAGIC   ('FRENCHSPANIEL',       'FRENCH SPANIEL'),
# MAGIC   ('ICELNDSHEEPDOG',      'ICELANDIC SHEEPDOG'),
# MAGIC   ('RUSSIANTOYTER',       'RUSSIAN TOY TERRIER'),
# MAGIC   ('SWISSHOUND',          'SWISS HOUND'),
# MAGIC   ('SHORTHAIRDOME',       'DOMESTIC SHORTHAIR'),
# MAGIC   ('TENNTRBRINDLE',       'TREEING TENNESSEE BRINDLE'),
# MAGIC   ('BOUVIERDEFLAN',       'BOUVIER DES FLANDRES'),
# MAGIC   ('CHIHUAHUALONG',       'CHIHUAHUA LONGHAIR'),
# MAGIC   ('CIRNECO',             'CIRNECO DELL''ETNA'),
# MAGIC   ('AUSTRALIANBERN',      'BERNEDOODLE'),
# MAGIC   ('AMERWATERSPAN',       'AMERICAN WATER SPANIEL'),
# MAGIC   ('SHEEPADOODLE',        'SHEEPADOODLE'),
# MAGIC   ('POMSKY',              'POMSKY'),
# MAGIC   ('HARRIER',             'HARRIER'),
# MAGIC   ('TORTOISE',            'DOMESTIC SHORTHAIR'),
# MAGIC   ('BARBETFRENCH',        'BARBET'),
# MAGIC   ('MIXEDRACE',           'MIXED BREED'),
# MAGIC   ('POTCAKEMIXED',        'POTCAKE'),
# MAGIC   ('PUMI',                'PUMI'),
# MAGIC   ('BICHONFRISEMI',       'BICHON FRISE'),
# MAGIC   ('CHIHUAHUAS',          'CHIHUAHUA'),
# MAGIC   ('FORMOSANMOUNTA',      'FORMOSAN MOUNTAIN DOG'),
# MAGIC   ('MCNABMIX',            'MCNAB DOG'),
# MAGIC   ('WHEATENTERRIER',      'SOFT COATED WHEATEN TERRIER'),
# MAGIC   ('PARSONJACKRUS',       'PARSON JACK RUSSELL TERRIER'),
# MAGIC   ('SCHNAUZER',           'SCHNAUZER'),
# MAGIC   ('XOLOITZCUINTLE',      'XOLOITZCUINTLI'),
# MAGIC   ('CHORKIE',             'CHORKIE'),
# MAGIC   ('SUSSEXSPAN',          'SUSSEX SPANIEL'),
# MAGIC   ('TOSA',                'TOSA'),
# MAGIC   ('TERRIERMIX',          'TERRIER MIX'),
# MAGIC   ('CAUCASIANSHEPH',      'CAUCASIAN SHEPHERD DOG'),
# MAGIC   ('SHIHTZUMIX',          'SHIH TZU MIX'),
# MAGIC   ('MINIATUREGOLDE',      'GOLDENDOODLE'),
# MAGIC   ('AMERICANCOCKER',      'AMERICAN COCKER SPANIEL'),
# MAGIC   ('JAPANBOBTAIL',        'JAPANESE BOBTAIL'),
# MAGIC   ('MUTT',                'MIXED BREED'),
# MAGIC   ('CHIWEENIE',           'CHIWEENIE'),
# MAGIC   ('KOOIKERHONJE',        'KOOIKERHONDJE'),
# MAGIC   ('TOYBOB',              'TOYBOB'),
# MAGIC   ('AMERICANPOCKET',      'AMERICAN BULLY'),
# MAGIC   ('TAMASKAN',            'TAMASKAN'),
# MAGIC   ('MIXJACKRUSS',         'JACK RUSSELL TERRIER'),
# MAGIC   ('INDIAN',              'INDIAN PARIAH DOG'),
# MAGIC   ('METIS',               'MIXED BREED'),
# MAGIC   ('SHORTHAIREDDO',       'DOMESTIC SHORTHAIR'),
# MAGIC   ('SLOVENSKYKOPOV',      'SLOVENSKY KOPOV'),
# MAGIC   ('SCHAPENDOES',         'SCHAPENDOES'),
# MAGIC   ('ASH',                 'AMERICAN SHORTHAIR'),
# MAGIC   ('LONGHAIREDCHI',       'CHIHUAHUA LONGHAIR'),
# MAGIC   ('MINIATUREDACHS',      'DACHSHUND MINIATURE'),
# MAGIC   ('SHIKOKU',             'SHIKOKU'),
# MAGIC   ('HUNGARIANVISZL',      'VIZSLA'),
# MAGIC   ('BELGIANSHEPHER',      'BELGIAN SHEPHERD DOG'),
# MAGIC   ('JINDOMIX',            'JINDO'),
# MAGIC   ('WHEATONTERRIER',      'SOFT COATED WHEATEN TERRIER'),
# MAGIC   ('PERUVIANHAIRLE',      'PERUVIAN HAIRLESS DOG'),
# MAGIC   ('XLBULLYANDCA',        'AMERICAN BULLY'),
# MAGIC   ('INDIANPARIAHD',       'INDIAN PARIAH DOG'),
# MAGIC   ('MIXEDBREED',          'MIXED BREED'),
# MAGIC   ('CLUMBERSPAN',         'CLUMBER SPANIEL'),
# MAGIC   ('TUXEDO',              'DOMESTIC SHORTHAIR'),
# MAGIC   ('SIBERIANFOREST',      'SIBERIAN'),
# MAGIC   ('TABY',                'DOMESTIC SHORTHAIR'),
# MAGIC   ('SOMALI',              'SOMALI'),
# MAGIC   ('COCONUTHOUND',        'POTCAKE'),
# MAGIC   ('MIXCAROLINAHU',       'CAROLINA DOG'),
# MAGIC   ('AUSTRALIASHEPP',      'AUSTRALIAN SHEPHERD'),
# MAGIC   ('KALPIE',              'AUSTRALIAN KELPIE'),
# MAGIC   ('GERMANSHEPARD',      'GERMAN SHEPHERD DOG'),
# MAGIC   ('POODLEMINBI',         'POODLE MINIATURE'),
# MAGIC   ('TERRIERX',            'TERRIER MIX'),
# MAGIC   ('NEWFOUNDLANDLA',      'NEWFOUNDLAND'),
# MAGIC   ('MINIATUREAMERI',      'MINIATURE AMERICAN SHEPHERD'),
# MAGIC   ('CHIHUAHUATERRI',      'CHIHUAHUA'),
# MAGIC   ('INDIANPARAIH',        'INDIAN PARIAH DOG'),
# MAGIC   ('YORKSHIRETERRI',      'YORKSHIRE TERRIER'),
# MAGIC   ('POINTERGERMAN',       'GERMAN POINTER'),
# MAGIC   ('TAHLTANBEARDO',       'TAHLTAN BEAR DOG'),
# MAGIC   ('ROTTWEILERGE',        'ROTTWEILER'),
# MAGIC   ('SHILOHSHEPHERD',      'SHILOH SHEPHERD'),
# MAGIC   ('STANDARDSCHNAU',      'STANDARD SCHNAUZER'),
# MAGIC   ('MALTESE',             'MALTESE'),
# MAGIC   ('AFGHANHOUND',         'AFGHAN HOUND'),
# MAGIC   ('SHIHTZUTERRIE',       'SHIH TZU'),
# MAGIC   ('BOSTON TERRIER',   'BOSTON TERRIER'),
# MAGIC   ('WIREHAIREDVIZSLA', 'WIREHAIRED VIZSLA'),
# MAGIC   ('DACHSHUND',        'DACHSHUND'),
# MAGIC   ('DACHSHUNDWH',      'DACHSHUND WIREHAIRED'),
# MAGIC   ('DACHSHUNDLH',      'DACHSHUND LONGHAIR'),
# MAGIC   ('SCHNAUZERMIN',     'MINIATURE SCHNAUZER'),
# MAGIC   ('SCHNAUZERSTAND',   'STANDARD SCHNAUZER'),
# MAGIC   ('SCHNAUZERGIANT',   'GIANT SCHNAUZER'),
# MAGIC   ('POODLETOY',        'POODLE TOY'),
# MAGIC   ('POODLEMIN',        'POODLE MINIATURE'),
# MAGIC   ('POODLESTND',       'POODLE STANDARD'),
# MAGIC   ('AUSSIEDOODLE',     'AUSSIEDOODLE'),
# MAGIC   ('GOLDENDOODLE',     'GOLDENDOODLE'),
# MAGIC   ('BERNEDOODLE',      'BERNEDOODLE'),
# MAGIC   ('LABRADOODLE',      'LABRADOODLE'),
# MAGIC   ('SHIHPOO',          'SHIHPOO'),
# MAGIC   ('SHIHTZU',          'SHIHTZU'),
# MAGIC   ('PUGPOO',           'PUG X POODLE'),
# MAGIC   ('AMERICANSTAFF',    'AMERICAN STAFFORDSHIRE TERRIER'),
# MAGIC   ('AMERICANPITBULLTER', 'AMERICAN PIT BULL TERRIER'),
# MAGIC   ('FRENCHBULLDOG',    'FRENCH BULLDOG'),
# MAGIC   ('AMERBULLDOG',    'AMERICAN BULLDOG'),
# MAGIC   ('ENGLISHCOCKERSPANIEL', 'ENGLISH COCKER SPANIEL'),
# MAGIC   ('COCKERSPAN',       'COCKER SPANIEL'),
# MAGIC   ('ENGLISHSPRINGERSPANIEL', 'ENGLISH SPRINGER SPANIEL'),
# MAGIC   ('WIREHAIREDPOINTINGGRIFFON', 'WIREHAIRED POINTING GRIFFON'),
# MAGIC   ('CHIHUAHUASH',      'CHIHUAHUA SHORTHAIR'),
# MAGIC   ('LABRADORRETR',        'LABRADOR RETRIEVER'),
# MAGIC   ('LABRADORRETRIV',      'LABRADOR RETRIEVER'),
# MAGIC   ('LABRADORRETREI',      'LABRADOR RETRIEVER'),
# MAGIC   ('LAB',                  'LABRADOR RETRIEVER'),
# MAGIC   ('GOLDENRETR',          'GOLDEN RETRIEVER'),
# MAGIC   ('GOLDENRETREIVE',      'GOLDEN RETRIEVER'),
# MAGIC   ('GOLDENRITIVER',       'GOLDEN RETRIEVER'),
# MAGIC   ('GERMSHEPHERD',        'GERMAN SHEPHERD DOG'),
# MAGIC   ('GERMANSHEPHERD',      'GERMAN SHEPHERD DOG'),
# MAGIC   ('GERMANSHEPPARD',      'GERMAN SHEPHERD DOG'),
# MAGIC   ('GERMANSHEPPHERD',     'GERMAN SHEPHERD DOG'),
# MAGIC   ('KINGSHEPPARD',        'GERMAN SHEPHERD DOG'),
# MAGIC   ('SHIHTZU',             'SHIH TZU'),
# MAGIC   ('SHITZUE',             'SHIH TZU'),
# MAGIC   ('COCKERSPAN',          'COCKER SPANIEL'),
# MAGIC   ('ENGLISHCOCKERSPANIEL','ENGLISH COCKER SPANIEL'),
# MAGIC   ('ENGLISHSPRINGERSPANIEL','ENGLISH SPRINGER SPANIEL'),
# MAGIC   ('CAVALIERSPAN',        'CAVALIER KING CHARLES SPANIEL'),
# MAGIC   ('SPANIEL',             'SPANIEL'),
# MAGIC   ('SPANIELENGLIS',       'ENGLISH TOY SPANIEL'),
# MAGIC   ('SPANIELAMERIC',       'AMERICAN COCKER SPANIEL'),
# MAGIC   ('FRENCHBULLDOG',       'FRENCH BULLDOG'),
# MAGIC   ('ENGLISHPTR',          'ENGLISH POINTER'),
# MAGIC   ('ENGPOINTER',          'ENGLISH POINTER'),
# MAGIC   ('POINTER',             'POINTER'),
# MAGIC   ('GERMSHPOINT',         'GERMAN SHORTHAIRED POINTER'),
# MAGIC   ('GERMWHPOINT',         'GERMAN WIREHAIRED POINTER'),
# MAGIC   ('WHPTGRIFFON',         'WIREHAIRED POINTING GRIFFON'),
# MAGIC   ('VIZSLA',              'VIZSLA'),
# MAGIC   ('VISZLA',              'VIZSLA'),
# MAGIC   ('VIZSLAWH',            'WIREHAIRED VIZSLA'),
# MAGIC   ('DACHSHUND',           'DACHSHUND'),
# MAGIC   ('DACHSHUNDMIN',        'DACHSHUND MINIATURE'),
# MAGIC   ('DACHSHUNDWH',         'DACHSHUND WIREHAIRED'),
# MAGIC   ('DACHSHUNDLH',         'DACHSHUND LONGHAIRED'),
# MAGIC   ('DACHSHUNDSTAN',       'DACHSHUND STANDARD'),
# MAGIC   ('DASCHUND',            'DACHSHUND'),
# MAGIC   ('STANDARDDACHSH',      'DACHSHUND STANDARD'),
# MAGIC   ('SCHNAUZERMIN',        'MINIATURE SCHNAUZER'),
# MAGIC   ('SCHNAUZERSTAND',      'STANDARD SCHNAUZER'),
# MAGIC   ('SCHNAUZERGIANT',      'GIANT SCHNAUZER'),
# MAGIC   ('MINIATURESCHNA',      'MINIATURE SCHNAUZER'),
# MAGIC   ('PODDLE',              'POODLE'),
# MAGIC   ('POODLE',              'POODLE'),
# MAGIC   ('POODLEMIN',           'POODLE MINIATURE'),
# MAGIC   ('POODLESTND',          'POODLE STANDARD'),
# MAGIC   ('STANDARDPOODLE',      'POODLE STANDARD'),
# MAGIC   ('POODLETOY',           'POODLE TOY'),
# MAGIC   ('TOYPOODLE',           'POODLE TOY'),
# MAGIC   ('CHIHUAHUASH',         'CHIHUAHUA SHORTHAIR'),
# MAGIC   ('CHIHUAHUALH',         'CHIHUAHUA LONGHAIR'),
# MAGIC   ('CHIHUAHUA',           'CHIHUAHUA'),
# MAGIC   ('MINPINSCHER',         'MINIATURE PINSCHER'),
# MAGIC   ('MINIATUREPINCH',      'MINIATURE PINSCHER'),
# MAGIC   ('GERMANPINSCHER',      'GERMAN PINSCHER'),
# MAGIC   ('PUG',                 'PUG'),
# MAGIC   ('BOXER',               'BOXER'),
# MAGIC   ('EUROPEANBOXER',       'BOXER'),
# MAGIC   ('ROTTWEILER',          'ROTTWEILER'),
# MAGIC   ('ROTTWEILERMIX',       'ROTTWEILER MIX'),
# MAGIC   ('BULLDOG',             'BULLDOG'),
# MAGIC   ('ENGBULLDOG',          'ENGLISH BULLDOG'),
# MAGIC   ('OLDEENGLISHBU',       'OLDE ENGLISH BULLDOGGE'),
# MAGIC   ('OLDENGBULLDOG',       'OLDE ENGLISH BULLDOGGE'),
# MAGIC   ('AMERBULLDOG',         'AMERICAN BULLDOG'),
# MAGIC   ('AMERICANBULLY',       'AMERICAN BULLY'),
# MAGIC   ('AMERICANBULL',        'AMERICAN BULLY'),
# MAGIC   ('XLAMERICANBUL',       'AMERICAN BULLY XL'),
# MAGIC   ('MICROAMERICAN',       'AMERICAN BULLY MICRO'),
# MAGIC   ('POCKETBULLY',         'AMERICAN BULLY POCKET'),
# MAGIC   ('BULLTERRIER',         'BULL TERRIER'),
# MAGIC   ('BULLTERRMIN',         'MINIATURE BULL TERRIER'),
# MAGIC   ('AMERICANSTAFF',       'AMERICAN STAFFORDSHIRE TERRIER'),
# MAGIC   ('STAFFORDSHIRET',      'AMERICAN STAFFORDSHIRE TERRIER'),
# MAGIC   ('AMPITBULLTER',        'AMERICAN PIT BULL TERRIER'),
# MAGIC   ('PITBULL',             'AMERICAN PIT BULL TERRIER'),
# MAGIC   ('PITBULLMIX',          'AMERICAN PIT BULL TERRIER MIX'),
# MAGIC   ('BELGMALINOIS',        'BELGIAN MALINOIS'),
# MAGIC   ('BELGIANMALINOI',      'BELGIAN MALINOIS'),
# MAGIC   ('BELGTERVUREN',        'BELGIAN TERVUREN'),
# MAGIC   ('BELGIANGROENEN',      'BELGIAN GROENENDAEL'),
# MAGIC   ('AUSTSHEPHERD',        'AUSTRALIAN SHEPHERD'),
# MAGIC   ('AUSTRALIANSHEPHERD',  'AUSTRALIAN SHEPHERD'),
# MAGIC   ('MINIAUSTRALIAN',      'MINIATURE AMERICAN SHEPHERD'),
# MAGIC   ('ENGSHEPHERD',         'ENGLISH SHEPHERD'),
# MAGIC   ('WHITESHEPHERD',       'WHITE SHEPHERD'),
# MAGIC   ('SHETLDSHEEPDOG',      'SHETLAND SHEEPDOG'),
# MAGIC   ('OLDENGSHEEPDOG',      'OLD ENGLISH SHEEPDOG'),
# MAGIC   ('DUTCHSHEPHERD',       'DUTCH SHEPHERD'),
# MAGIC   ('ANATOLSHEPHERD',      'ANATOLIAN SHEPHERD DOG'),
# MAGIC   ('PYRENSHEPHERD',       'PYRENEAN SHEPHERD'),
# MAGIC   ('CANAANDOG',           'CANAAN DOG'),
# MAGIC   ('KARELIANBEAR',        'KARELIAN BEAR DOG'),
# MAGIC   ('CAROLINADOG',         'CAROLINA DOG'),
# MAGIC   ('MAREMMASHEEPDG',      'MAREMMA SHEEPDOG'),
# MAGIC   ('PICARDYSHEEPDG',      'PICARDY SHEEPDOG'),
# MAGIC   ('DUTCHSHEEPDOG',       'SCHAPENDOES'),
# MAGIC   ('POLISHLOWLAND',       'POLISH LOWLAND SHEEPDOG'),
# MAGIC   ('AUSTCATTLEDOG',       'AUSTRALIAN CATTLE DOG'),
# MAGIC   ('QUEENSLANDHEEL',      'AUSTRALIAN CATTLE DOG'),
# MAGIC   ('AUSTRALIANCATT',      'AUSTRALIAN CATTLE DOG'),
# MAGIC   ('AUTRALIANCATTL',      'AUSTRALIAN CATTLE DOG'),
# MAGIC   ('AUSTKELPIE',          'AUSTRALIAN KELPIE'),
# MAGIC   ('KELPIE',              'AUSTRALIAN KELPIE'),
# MAGIC   ('WELSHCORGIPEM',      'PEMBROKE WELSH CORGI'),
# MAGIC   ('WELSHCORGICAR',       'CARDIGAN WELSH CORGI'),
# MAGIC   ('PEMBROKEWELSH',       'PEMBROKE WELSH CORGI'),
# MAGIC   ('PEMBROOKECORGI',      'PEMBROKE WELSH CORGI'),
# MAGIC   ('CORGIPEMBROKE',       'PEMBROKE WELSH CORGI'),
# MAGIC   ('CORGICARDIGAN',      'CARDIGAN WELSH CORGI'),
# MAGIC   ('BORDERCOLLIE',        'BORDER COLLIE'),
# MAGIC   ('BEARDEDCOLLIE',       'BEARDED COLLIE'),
# MAGIC   ('COLLIEROUGH',         'COLLIE ROUGH'),
# MAGIC   ('COLLIESMOOTH',        'COLLIE SMOOTH'),
# MAGIC   ('PORTUGUESECATTLEDOG',  'PORTUGUESE CATTLE DOG'),
# MAGIC   ('BRITTANY',            'BRITTANY'),
# MAGIC   ('WEIMARANER',          'WEIMARANER'),
# MAGIC   ('GORDONSETTER',        'GORDON SETTER'),
# MAGIC   ('ENGLISHSETTER',       'ENGLISH SETTER'),
# MAGIC   ('IRISHSETTER',         'IRISH SETTER'),
# MAGIC   ('BRACCOITALIANO',      'BRACCO ITALIANO'),
# MAGIC   ('SPINONEITAL',         'SPINONE ITALIANO'),
# MAGIC   ('ITALGREYHOUND',       'ITALIAN GREYHOUND'),
# MAGIC   ('GREYHOUND',           'GREYHOUND'),
# MAGIC   ('WHIPPET',             'WHIPPET'),
# MAGIC   ('BASSETTHOUND',        'BASSET HOUND'),
# MAGIC   ('BLOODHOUND',          'BLOODHOUND'),
# MAGIC   ('BLUETICKHOUND',       'BLUETICK COONHOUND'),
# MAGIC   ('ENGCOONHOUND',        'ENGLISH COONHOUND'),
# MAGIC   ('REDBONEHOUND',        'REDBONE COONHOUND'),
# MAGIC   ('TRWALKERHOUND',       'TREEING WALKER COONHOUND'),
# MAGIC   ('HOUND',               'HOUND'),
# MAGIC   ('FEIST',               'FEIST'),
# MAGIC   ('MOUNTAINCUR',         'MOUNTAIN CUR'),
# MAGIC   ('TREEINGCUR',          'TREEING CUR'),
# MAGIC   ('BLACKMOUTHCUR',       'BLACK MOUTH CUR'),
# MAGIC   ('BLACKMOUTHKER',       'BLACK MOUTH CUR'),
# MAGIC   ('PBGV',                'PETIT BASSET GRIFFON VENDEEN'),
# MAGIC   ('GBGV',                'GRAND BASSET GRIFFON VENDEEN'),
# MAGIC   ('PHARAOHHOUND',        'PHARAOH HOUND'),
# MAGIC   ('PHAROAHHOUND',        'PHARAOH HOUND'),
# MAGIC   ('IBIZANHOUND',         'IBIZAN HOUND'),
# MAGIC   ('SALUKI',              'SALUKI'),
# MAGIC   ('BORZOI',              'BORZOI'),
# MAGIC   ('KEESHOND',            'KEESHOND'),
# MAGIC   ('ALASKMALAMUTE',       'ALASKAN MALAMUTE'),
# MAGIC   ('ALASKANHUSKY',        'ALASKAN HUSKY'),
# MAGIC   ('SIBERIANHUSKY',       'SIBERIAN HUSKY'),
# MAGIC   ('SAMOYED',             'SAMOYED'),
# MAGIC   ('AKITA',               'AKITA'),
# MAGIC   ('JAPANESECHIN',        'JAPANESE CHIN'),
# MAGIC   ('SHIBAINU',           'SHIBA INU'),
# MAGIC   ('KOREANJINDO',         'JINDO'),
# MAGIC   ('JINDO',               'JINDO'),
# MAGIC   ('KOMONDOR',            'KOMONDOR'),
# MAGIC   ('KUVASZ',              'KUVASZ'),
# MAGIC   ('LEONBERGER',          'LEONBERGER'),
# MAGIC   ('GREATDANE',           'GREAT DANE'),
# MAGIC   ('GREATPYRENEES',       'GREAT PYRENEES'),
# MAGIC   ('STBERNARDRGH',        'SAINT BERNARD ROUGH'),
# MAGIC   ('STBERNARDSMTH',       'SAINT BERNARD SMOOTH'),
# MAGIC   ('LANDSEER',            'LANDSEER'),
# MAGIC   ('NEWFOUNDLAND',        'NEWFOUNDLAND'),
# MAGIC   ('GRSWISSMTN',          'GREATER SWISS MOUNTAIN DOG'),
# MAGIC   ('BERNESEMTNDOG',       'BERNESE MOUNTAIN DOG'),
# MAGIC   ('BERNESEMOUNTAINDOG',  'BERNESE MOUNTAIN DOG'),
# MAGIC   ('BERNESEMOUNTAI',  'BERNESE MOUNTAIN DOG'),
# MAGIC   ('DOBERMANPINSCH',      'DOBERMAN PINSCHER'),
# MAGIC   ('CANECORSO',          'CANE CORSO'),
# MAGIC   ('NEAPOLITANMAST',      'NEAPOLITAN MASTIFF'),
# MAGIC   ('MASTIFF',             'MASTIFF'),
# MAGIC   ('BULLMASTIFF',         'BULLMASTIFF'),
# MAGIC   ('DOGUEDEBORDX',        'DOGUE DE BORDEAUX'),
# MAGIC   ('BOERBOEL',            'BOERBOEL'),
# MAGIC   ('DOGOARGENTINO',       'DOGO ARGENTINO'),
# MAGIC   ('CATAHOULA',           'CATAHOULA LEOPARD DOG'),
# MAGIC   ('KANGAL',              'KANGAL'),
# MAGIC   ('HOVAWART',            'HOVAWART'),
# MAGIC   ('ENTLEBUCHER',         'ENTLEBUCHER MOUNTAIN DOG'),
# MAGIC   ('PUDELPOINTER',        'PUDELPOINTER'),
# MAGIC   ('PRESACANARIO',       'PRESA CANARIO'),
# MAGIC   ('PRESSACANARIO',       'PRESA CANARIO'),
# MAGIC   ('AMERESKIMO',          'AMERICAN ESKIMO DOG'),
# MAGIC   ('RATTERRIER',          'RAT TERRIER'),
# MAGIC   ('TOYFOXTERRIER',       'TOY FOX TERRIER'),
# MAGIC   ('CAIRNTERRIER',        'CAIRN TERRIER'),
# MAGIC   ('SCOTTERRIER',         'SCOTTISH TERRIER'),
# MAGIC   ('AIREDALETERR',        'AIREDALE TERRIER'),
# MAGIC   ('WELSHTERRIER',       'WELSH TERRIER'),
# MAGIC   ('LAKELANDTERR',        'LAKELAND TERRIER'),
# MAGIC   ('SEALYHAMTERR',        'SEALYHAM TERRIER'),
# MAGIC   ('IRISHTERRIER',        'IRISH TERRIER'),
# MAGIC   ('PATTERDALETERR',      'PATTERDALE TERRIER'),
# MAGIC   ('KERRYBLUETERR',       'KERRY BLUE TERRIER'),
# MAGIC   ('NORWICHTERRIER',      'NORWICH TERRIER'),
# MAGIC   ('NORFOLKTERRIER',      'NORFOLK TERRIER'),
# MAGIC   ('BORDERTER RIER',      'BORDER TERRIER'),
# MAGIC   ('FOXTERWIRE',          'WIRE FOX TERRIER'),
# MAGIC   ('FOXTERSMOOTH',        'SMOOTH FOX TERRIER'),
# MAGIC   ('WESTHIGHLAND',        'WEST HIGHLAND WHITE TERRIER'),
# MAGIC   ('WESTHIGHLANDT',       'WEST HIGHLAND WHITE TERRIER'),
# MAGIC   ('GANARASKAN',          'GANARASKAN'),
# MAGIC   ('NSDUCKTOLLING',       'NOVA SCOTIA DUCK TOLLING RETRIEVER'),
# MAGIC   ('FLATCOATRETR',       'FLAT COATED RETRIEVER'),
# MAGIC   ('CHESABAYRETR',       'CHESAPEAKE BAY RETRIEVER'),
# MAGIC   ('PORTWATERDOG',       'PORTUGUESE WATER DOG'),
# MAGIC   ('SPANWATERDOG',       'SPANISH WATER DOG'),
# MAGIC
# MAGIC   -- designer crosses and mix flags
# MAGIC   ('AUSSIEDOODLE',       'AUSSIEDOODLE'),
# MAGIC   ('AUSSIEDOODLEMINI',   'AUSSIEDOODLE'),
# MAGIC   ('AUSSIEDOODLEAUSSIE', 'AUSSIEDOODLE'),
# MAGIC   ('AUSSIEDOODLEBERNE',  'AUSSIEDOODLE'),
# MAGIC   ('AUSSIEPOODLE',       'AUSSIEDOODLE'),
# MAGIC   ('AUSSIDOODLE',        'AUSSIEDOODLE'),
# MAGIC   ('AUSSIEDOODLEMIN',    'AUSSIEDOODLE'),
# MAGIC   ('AUSSIEDOODLEAUSSI',  'AUSSIEDOODLE'),
# MAGIC   ('GOLDENDOODLE',       'GOLDENDOODLE'),
# MAGIC   ('MINIGOLDENDOOD',     'GOLDENDOODLE'),
# MAGIC   ('MINIGOLDENDOO',      'GOLDENDOODLE'),
# MAGIC   ('GOLDENDOODLEG',    'GOLDENDOODLE'),
# MAGIC   ('BERNEDOODLE',        'BERNEDOODLE'),
# MAGIC   ('BERNADOODLE',        'BERNEDOODLE'),
# MAGIC   ('AUSSIEBERNEDOO',     'BERNEDOODLE'),
# MAGIC   ('LABRADOODLE',        'LABRADOODLE'),
# MAGIC   ('AUSTRALIANLABR',     'LABRADOODLE'),
# MAGIC   ('AUSTRAILANLABR',     'LABRADOODLE'),
# MAGIC   ('AUSTRIALIANLAB',     'LABRADOODLE'),
# MAGIC   ('WHOODLE',            'WHOODLE'),
# MAGIC   ('COCKAPOO',           'COCKAPOO'),
# MAGIC   ('MINICOCKAPOO',       'COCKAPOO'),
# MAGIC   ('SHIHPOO',            'SHIHPOO'),
# MAGIC   ('SHIHPOO',            'SHIHPOO'),
# MAGIC   ('PUGPOO',             'PUG X POODLE'),
# MAGIC
# MAGIC   -- cats: domestic coats and common breeds
# MAGIC   ('DOMESTICSH',         'DOMESTIC SHORTHAIR'),
# MAGIC   ('DOMESTICSHORT',      'DOMESTIC SHORTHAIR'),
# MAGIC   ('DSH',                'DOMESTIC SHORTHAIR'),
# MAGIC   ('DOMESTICLH',         'DOMESTIC LONGHAIR'),
# MAGIC   ('DOMESTICLONGHAIR',   'DOMESTIC LONGHAIR'),
# MAGIC   ('DLH',                'DOMESTIC LONGHAIR'),
# MAGIC   ('DOMESTICMH',         'DOMESTIC MEDIUMHAIR'),
# MAGIC   ('MEDIUMHAIRDOM',      'DOMESTIC MEDIUMHAIR'),
# MAGIC   ('DMH',                'DOMESTIC MEDIUMHAIR'),
# MAGIC   ('BRITISHSH',          'BRITISH SHORTHAIR'),
# MAGIC   ('BRITISHSHORTHAIR',   'BRITISH SHORTHAIR'),
# MAGIC   ('EUROPEANSH',         'EUROPEAN SHORTHAIR'),
# MAGIC   ('EUROPEANSHORTHAIR',  'EUROPEAN SHORTHAIR'),
# MAGIC   ('EXOTICSH',           'EXOTIC SHORTHAIR'),
# MAGIC   ('EXOTICSHORTHAIR',    'EXOTIC SHORTHAIR'),
# MAGIC   ('ORIENTALSH',         'ORIENTAL SHORTHAIR'),
# MAGIC   ('ORIENTALSHORTHAIR',  'ORIENTAL SHORTHAIR'),
# MAGIC   ('AMERSH',             'AMERICAN SHORTHAIR'),
# MAGIC   ('AMERICANSHORT',      'AMERICAN SHORTHAIR'),
# MAGIC   ('RAGDOLL',            'RAGDOLL'),
# MAGIC   ('RAGDOLLMIX',         'RAGDOLL'),
# MAGIC   ('PERSIAN',            'PERSIAN'),
# MAGIC   ('PERSIANMIX',         'PERSIAN'),
# MAGIC   ('HIMALAYAN',          'HIMALAYAN'),
# MAGIC   ('MAINECOON',          'MAINE COON'),
# MAGIC   ('MAINECOONMIX',       'MAINE COON'),
# MAGIC   ('SIAMESE',            'SIAMESE'),
# MAGIC   ('SIAMESEMIX',         'SIAMESE'),
# MAGIC   ('RUSSIANBLUE',        'RUSSIAN BLUE'),
# MAGIC   ('BENGAL',             'BENGAL'),
# MAGIC   ('BENGALMIX',          'BENGAL'),
# MAGIC   ('SAVANNAH',           'SAVANNAH'),
# MAGIC   ('SPHYNX',             'SPHYNX'),
# MAGIC   ('DEVONREX',           'DEVON REX'),
# MAGIC   ('CORNISHREX',         'CORNISH REX'),
# MAGIC   ('SCOTTISHFOLD',       'SCOTTISH FOLD'),
# MAGIC   ('SCOTTISHFOLDM',      'SCOTTISH FOLD'),
# MAGIC   ('EGYPTIANMAU',        'EGYPTIAN MAU'),
# MAGIC   ('MANX',               'MANX'),
# MAGIC   ('BIRMAN',             'BIRMAN'),
# MAGIC   ('BALINESE',           'BALINESE'),
# MAGIC   ('JAVANESE',           'JAVANESE'),
# MAGIC   ('TONKINESE',          'TONKINESE'),
# MAGIC   ('SINGAPURA',          'SINGAPURA'),
# MAGIC   ('KORAT',              'KORAT'),
# MAGIC   ('CHARTREUX',          'CHARTREUX'),
# MAGIC   ('NORWGNFOREST',       'NORWEGIAN FOREST CAT'),
# MAGIC   ('NORWEGIANFOREST',    'NORWEGIAN FOREST CAT'),
# MAGIC   ('TURKISHANGORA',      'TURKISH ANGORA'),
# MAGIC   ('TURKISHVAN',         'TURKISH VAN'),
# MAGIC   ('PIXIEBOBSH',         'PIXIE-BOB'),
# MAGIC   ('PIXIEBOBLH',         'PIXIE-BOB'),
# MAGIC   ('MUNCHKINSH',         'MUNCHKIN'),
# MAGIC   ('AMERWIREHAIR',       'AMERICAN WIREHAIR'),
# MAGIC   ('AMERCURLSH',         'AMERICAN CURL'),
# MAGIC   ('AMERCURLLH',         'AMERICAN CURL'),
# MAGIC   ('DEVONREX',           'DEVON REX'),
# MAGIC   ('CORNISHREX',         'CORNISH REX'),
# MAGIC   ('HAVANABROWN',        'HAVANA BROWN'),
# MAGIC   ('DOMESTICSH',         'DOMESTIC SHORTHAIR'),
# MAGIC   ('DOMESTICSHORTHAIR',  'DOMESTIC SHORTHAIR'),
# MAGIC   ('DOMESTICLONGHAIR',   'DOMESTIC LONGHAIR'),
# MAGIC   ('DOMESTICLH',         'DOMESTIC LONGHAIR'),
# MAGIC   ('DOMESTICMEDIUMHAIR', 'DOMESTIC MEDIUMHAIR'),
# MAGIC   ('DOMESTICMH',         'DOMESTIC MEDIUMHAIR'),
# MAGIC   ('BRITISHSHORTHAIR',   'BRITISH SHORTHAIR'),
# MAGIC   ('BRITISHSH',          'BRITISH SHORTHAIR'),
# MAGIC   ('AMERSH',             'AMERICAN SHORTHAIR'),
# MAGIC   ('EUROPEANSHORTHAIR',  'EUROPEAN SHORTHAIR'),
# MAGIC   ('EUROPEANSH',         'EUROPEAN SHORTHAIR'),
# MAGIC   ('EXOTICSHORTHAIR',    'EXOTIC SHORTHAIR'),
# MAGIC   ('EXOTICSH',           'EXOTIC SHORTHAIR'),
# MAGIC   ('ORIENTALSHORTHAIR',  'ORIENTAL SHORTHAIR'),
# MAGIC   ('ORIENTALSH',         'ORIENTAL SHORTHAIR'),
# MAGIC   ('MAINECOON',          'MAINE COON'),
# MAGIC   ('RAGDOLL',            'RAGDOLL'),
# MAGIC   ('PERSIAN',            'PERSIAN'),
# MAGIC   ('HIMALAYAN',          'HIMALAYAN'),
# MAGIC   ('SIAMESE',            'SIAMESE'),
# MAGIC   ('BENGAL',             'BENGAL'),
# MAGIC   ('SPHYNX',             'SPHYNX'),
# MAGIC   ('DEVONREX',           'DEVON REX'),
# MAGIC   ('CORNISHREX',         'CORNISH REX'),
# MAGIC   ('SCOTTISHFOLD',       'SCOTTISH FOLD'),
# MAGIC   ('NORWEGIANFOREST',    'NORWEGIAN FOREST CAT'),
# MAGIC   ('TURKISHANGORA',      'TURKISH ANGORA'),
# MAGIC   ('TURKISHVAN',         'TURKISH VAN')
# MAGIC   ),
# MAGIC
# MAGIC -- 2) Normalize keys exactly like Silver does
# MAGIC norm AS (
# MAGIC   SELECT
# MAGIC     regexp_replace(upper(trim(key)), '[^A-Z0-9]', '') AS breed_variant_key,
# MAGIC     val AS breed_standard
# MAGIC   FROM v
# MAGIC ),
# MAGIC
# MAGIC -- 3) Deduplicate in case you listed the same key more than once
# MAGIC dedup AS (
# MAGIC   SELECT breed_variant_key, max(breed_standard) AS breed_standard
# MAGIC   FROM norm
# MAGIC   GROUP BY breed_variant_key
# MAGIC )
# MAGIC
# MAGIC -- 4) Upsert into the mapping table
# MAGIC MERGE INTO pets.ref.breed_mapping AS t
# MAGIC USING dedup AS s
# MAGIC ON t.breed_variant_key = s.breed_variant_key
# MAGIC WHEN MATCHED THEN
# MAGIC   UPDATE SET t.breed_standard = s.breed_standard
# MAGIC WHEN NOT MATCHED THEN
# MAGIC   INSERT (breed_variant_key, breed_standard)
# MAGIC   VALUES (s.breed_variant_key, s.breed_standard);
# MAGIC

# COMMAND ----------

# MAGIC %sql
# MAGIC MERGE INTO pets.core.licensed_pets_silver s
# MAGIC USING (
# MAGIC   SELECT breed_variant_key, max(breed_standard) AS breed_standard
# MAGIC   FROM pets.ref.breed_mapping
# MAGIC   GROUP BY breed_variant_key
# MAGIC ) m
# MAGIC ON s.breed_variant_key = m.breed_variant_key
# MAGIC WHEN MATCHED THEN UPDATE SET
# MAGIC   s.breed_standard = m.breed_standard,
# MAGIC   s.breed_mapped   = TRUE;
# MAGIC

# COMMAND ----------

# MAGIC %sql
# MAGIC SELECT breed_raw, breed_variant_key, COUNT(*) AS cnt
# MAGIC FROM pets.core.licensed_pets_silver
# MAGIC LEFT ANTI JOIN pets.ref.breed_mapping m
# MAGIC   ON pets.core.licensed_pets_silver.breed_variant_key = m.breed_variant_key
# MAGIC GROUP BY breed_raw, breed_variant_key
# MAGIC ORDER BY cnt DESC, breed_raw;
# MAGIC

# COMMAND ----------

# MAGIC %sql
# MAGIC -- total rows
# MAGIC WITH total AS (
# MAGIC   SELECT COUNT(*) AS n FROM pets.core.licensed_pets_silver
# MAGIC ),
# MAGIC unmapped AS (
# MAGIC   SELECT COUNT(*) AS n
# MAGIC   FROM pets.core.licensed_pets_silver s
# MAGIC   LEFT ANTI JOIN pets.ref.breed_mapping m
# MAGIC     ON s.breed_variant_key = m.breed_variant_key
# MAGIC )
# MAGIC SELECT total.n  AS total_rows,
# MAGIC        unmapped.n AS unmapped_rows,
# MAGIC        ROUND(100.0 * unmapped.n / total.n, 2) AS pct_unmapped
# MAGIC FROM total, unmapped;
# MAGIC